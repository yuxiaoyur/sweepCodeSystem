webpackJsonp([100],{sIpJ:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e=s("E4LH"),l=(s("Q7M0"),{data:function(){return{visible:!1,isReadOnly:!0,dataForm:{id:0,tswt:"",tswtList:[],slsj:"",sqzt:"",sqms:"",zbdw:"",blqk:"",address:"",bllc:[{lcmc:"",lcsj:"",lcms:""}]},dataRule:{tswt:[{required:!0,message:"投诉问题不能为空",trigger:"blur"}],slsj:[{required:!0,message:"受理时间不能为空",trigger:"blur"},{validator:function(t,a,s){Object(e.a)(a)?s():s(new Error("时间格式错误"))},trigger:"blur"}]},bllcRules:{lcmc:[{required:!0,message:"流程名称不能为空",trigger:"blur"},{max:8,message:"长度不能超过8个字",trigger:"blur"}]}}},created:function(){},methods:{init:function(t){var a=this;this.visible=!0,this.getTswt(),this.$nextTick(function(){a.dataForm.bllc=[{lcmc:"",lcsj:"",lcms:""}],a.$refs.dataForm.resetFields(),a.dataForm.id=t,a.dataForm.id&&a.$http({url:a.$http.adornUrl("/mssq/cfts/detail?id="+a.dataForm.id),method:"get"}).then(function(t){var s=t.data;s&&s.successful?(a.dataForm.slsj=s.data.slsj,a.dataForm.sqzt=s.data.sqzt,a.dataForm.sqms=s.data.sqms,a.dataForm.zbdw=s.data.zbdw,a.dataForm.blqk=s.data.blqk,a.dataForm.address=s.data.address,a.dataForm.bllc=s.data.bllc,a.dataForm.tswt=s.data.wtms):(console.log("ERROR",s),a.$message.error("操作失败"))})})},getTswt:function(){var t=this;this.$http({url:this.$http.adornUrl("/mssq/queryCfts"),method:"get"}).then(function(a){var s=a.data;s.successful?t.dataForm.tswtList=s.data:console.log("ERROR",s)})},dataFormSubmit:function(){for(var t=this,a=new Array,s=new Array,e=new Array,l=this.dataForm.bllc,r=0;r<l.length;r++)a.push(l[r].lcmc.length>0?l[r].lcmc:"--"),s.push(l[r].lcsj.length>0?l[r].lcsj:"--"),e.push(l[r].lcms.length>0?l[r].lcms:"--");this.$refs.dataForm.validate(function(l){l&&t.$http({url:t.$http.adornUrl("/mssq/cfts/"+(t.dataForm.id?"update":"save")),method:"post",params:t.$http.adornParams({id:t.dataForm.id||void 0,slsj:t.dataForm.slsj,sqzt:t.dataForm.sqzt,sqms:t.dataForm.sqms,zbdw:t.dataForm.zbdw,blqk:t.dataForm.blqk,tswt:t.dataForm.tswt,address:t.dataForm.address})}).then(function(l){var r=l.data;r&&r.successful?t.$http({url:t.$http.adornUrl("/mssq/cfts/bllc"),method:"post",params:t.$http.adornParams({id:r.data,lcmc:a.toString(),lcsj:s.toString(),lcms:e.toString()})}).then(function(a){var s=a.data;s&&s.successful?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.visible=!1,t.$emit("refreshDataList")}}):t.$message.error(s.message)}):t.$message.error(r.message)})})},closeDialog:function(){this.dataForm.bllc=[{lcmc:"",lcsj:"",lcms:""}]},addLc:function(){this.dataForm.bllc.push({lcmc:"",lcsj:"",lcms:""})},deleteLc:function(t,a){this.index=this.dataForm.bllc.indexOf(t),-1!==a&&this.dataForm.bllc.splice(a,1)}}}),r={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("el-dialog",{attrs:{title:t.dataForm.id?"修改":"新增","close-on-click-modal":!1,visible:t.visible},on:{"update:visible":function(a){t.visible=a},close:t.closeDialog}},[s("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"投诉问题",prop:"tswt"}},[s("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"",disabled:!!t.dataForm.id},model:{value:t.dataForm.tswt,callback:function(a){t.$set(t.dataForm,"tswt",a)},expression:"dataForm.tswt"}},t._l(t.dataForm.tswtList,function(t){return s("el-option",{attrs:{label:t.dataName,value:t.dataId}})}))],1),t._v(" "),s("el-form-item",{attrs:{label:"受理时间",prop:"slsj"}},[s("el-input",{attrs:{placeholder:"格式（yyyy-MM-dd HH:mm:ss）"},model:{value:t.dataForm.slsj,callback:function(a){t.$set(t.dataForm,"slsj",a)},expression:"dataForm.slsj"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"诉求主题",prop:"sqzt"}},[s("el-input",{model:{value:t.dataForm.sqzt,callback:function(a){t.$set(t.dataForm,"sqzt",a)},expression:"dataForm.sqzt"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"诉求描述",prop:"sqms"}},[s("el-input",{attrs:{type:"textarea",rows:4},model:{value:t.dataForm.sqms,callback:function(a){t.$set(t.dataForm,"sqms",a)},expression:"dataForm.sqms"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"转办单位",prop:"zbdw"}},[s("el-input",{model:{value:t.dataForm.zbdw,callback:function(a){t.$set(t.dataForm,"zbdw",a)},expression:"dataForm.zbdw"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"办理情况",prop:"blqk"}},[s("el-input",{attrs:{type:"textarea",rows:4},model:{value:t.dataForm.blqk,callback:function(a){t.$set(t.dataForm,"blqk",a)},expression:"dataForm.blqk"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"办理流程",prop:"bllc"}},t._l(t.dataForm.bllc,function(a,e){return s("div",[s("el-row",[s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{prop:"bllc."+e+".lcmc",rules:t.bllcRules.lcmc}},[s("el-input",{staticStyle:{width:"150px"},attrs:{size:"small",placeholder:"流程名称"},model:{value:a.lcmc,callback:function(s){t.$set(a,"lcmc",s)},expression:"item.lcmc"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",[s("el-input",{staticStyle:{width:"150px"},attrs:{size:"small",placeholder:"流程时间"},model:{value:a.lcsj,callback:function(s){t.$set(a,"lcsj",s)},expression:"item.lcsj"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:11}},[s("el-form-item",[s("el-input",{staticStyle:{width:"280px"},attrs:{size:"small",placeholder:"流程描述"},model:{value:a.lcms,callback:function(s){t.$set(a,"lcms",s)},expression:"item.lcms"}})],1)],1),t._v(" "),s("el-col",{attrs:{span:1}},[s("el-form-item",[e>0?s("i",{staticClass:"el-icon-remove-outline",on:{click:function(s){t.deleteLc(a,e)}}}):t._e(),t._v(" "),0==e?s("i",{staticClass:"el-icon-circle-plus-outline",on:{click:t.addLc}}):t._e()])],1)],1)],1)})),t._v(" "),s("el-form-item",{attrs:{label:"地址",prop:"address"}},[s("el-input",{model:{value:t.dataForm.address,callback:function(a){t.$set(t.dataForm,"address",a)},expression:"dataForm.address"}})],1)],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(a){t.visible=!1}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(a){t.dataFormSubmit()}}},[t._v("确定")])],1)],1)},staticRenderFns:[]},o=s("46Yf")(l,r,!1,null,null,null);a.default=o.exports}});