webpackJsonp([8,27],{DAgR:function(e,t,a){var r=a("JRvJ");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("FIqI")("a4ad1d16",r,!0,{})},JRvJ:function(e,t,a){(e.exports=a("UTlt")(!1)).push([e.i,"\n.mod-menu .menu-list__input > .el-input__inner,\n.mod-menu .icon-list__input > .el-input__inner {\n  cursor: pointer;\n}\n.mod-menu__icon-popover {\n  max-width: 370px;\n}\n.mod-menu__icon-list {\n  max-height: 180px;\n  padding: 0;\n  margin: -8px 0 0 -8px;\n}\n.mod-menu__icon-list > .el-button {\n    padding: 8px;\n    margin: 8px 0 0 8px;\n}\n.mod-menu__icon-list > .el-button > span {\n      display: inline-block;\n      vertical-align: middle;\n      width: 18px;\n      height: 18px;\n      font-size: 18px;\n}\n.mod-menu .icon-list__tips {\n  font-size: 18px;\n  text-align: center;\n  color: #e6a23c;\n  cursor: pointer;\n}\n",""])},QowZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("0xDb"),n=(a("Q7M0"),{data:function(){return{visible:!1,dataForm:{id:0,parentType:1,deptName:"",parentId:-1,name:"",deptOrder:0,province:"",city:"",area:"",street:"",region:[],proList:[],cityList:[],areaList:[]},dataRule:{deptName:[{required:!0,message:"部门名称不能为空",trigger:"blur"},{max:10,message:"长度不能超过10个字",trigger:"blur"}],province:[{required:!0,message:"省份不能为空",trigger:"blur"},{max:20,message:"长度有误",trigger:"blur"}],city:[{max:20,message:"长度有误",trigger:"blur\t"}],area:[{max:20,message:"长度有误",trigger:"blur\t"}],street:[{max:25,message:"长度不能超过25个字",trigger:"blur\t"}],deptOrder:[{required:!0,message:"排序号不能为空",trigger:"change"}],parentType:[{required:!0,message:"类型不能为空",trigger:"change"}]},deptList:[],deptListTreeProps:{label:"deptName",children:"children"}}},created:function(){this.getPro()},methods:{init:function(e){var t=this;this.dataForm.id=e||0,this.dataForm.cityList=[],this.dataForm.areaList=[],this.$http({url:this.$http.adornUrl("/dept/list"),method:"get",params:this.$http.adornParams()}).then(function(e){var a=e.data;a.successful?t.deptList=Object(r.c)(a.data,"id","parentId"):(console.log("ERROR",a),t.$message.error("操作失败"))}).then(function(){t.dataForm.parentId=-1,t.dataForm.deptOrder=0,t.visible=!0,t.$nextTick(function(){t.$refs.dataForm.resetFields()})}).then(function(){t.dataForm.id&&t.$http({url:t.$http.adornUrl("/dept/getDeptById"),method:"get",params:t.$http.adornParams({id:t.dataForm.id},!1)}).then(function(e){var a=e.data;a&&a.successful&&(t.dataForm.id=a.data.id,t.dataForm.parentType=parseInt(a.data.parentType),t.dataForm.deptName=a.data.deptName,t.dataForm.parentId=a.data.parentId,t.dataForm.deptOrder=a.data.deptOrder,t.dataForm.province=a.data.province,t.dataForm.city=a.data.city,t.dataForm.area=a.data.area,t.dataForm.street=a.data.street,t.proChange(t.dataForm.province),t.cityChange(t.dataForm.city),t.deptListTreeSetCurrentNode())})})},deptListTreeCurrentChangeHandle:function(e,t){this.dataForm.parentId=e.id,this.dataForm.name=e.deptName},deptListTreeSetCurrentNode:function(){this.$refs.deptListTree.setCurrentKey(this.dataForm.parentId),this.dataForm.name=(this.$refs.deptListTree.getCurrentNode()||{}).deptName},getPro:function(){var e=this;this.$http({url:this.$http.adornUrl("/meta/getMetaByTypeCode"),method:"get",params:this.$http.adornParams({typeCode:"region"},!1)}).then(function(t){var a=t.data;if(a.successful){var r=[];e.dataForm.region=a.data;for(var n=0;n<e.dataForm.region.length;n++)"-1"==e.dataForm.region[n].parentCode&&r.push(e.dataForm.region[n]);e.dataForm.proList=r}else console.log("ERROR",a)})},proChange:function(e){for(var t=[],a="",r=0;r<this.dataForm.region.length;r++)if(e==this.dataForm.region[r].dataCode){a=this.dataForm.region[r].id;break}for(r=0;r<this.dataForm.region.length;r++)a==this.dataForm.region[r].parentCode&&t.push(this.dataForm.region[r]);this.dataForm.cityList=t},cityChange:function(e){for(var t=[],a="",r=0;r<this.dataForm.region.length;r++)if(e==this.dataForm.region[r].dataCode){a=this.dataForm.region[r].id;break}console.log(a);for(r=0;r<this.dataForm.region.length;r++)a==this.dataForm.region[r].parentCode&&t.push(this.dataForm.region[r]);this.dataForm.areaList=t},dataFormSubmit:function(){var e=this;this.$refs.dataForm.validate(function(t){t&&e.$http({url:e.$http.adornUrl("/dept/"+(e.dataForm.id?"update":"save")),method:"post",data:{id:e.dataForm.id||void 0,parentType:e.dataForm.parentType,deptName:e.dataForm.deptName,parentId:e.dataForm.parentId,province:e.dataForm.province,city:e.dataForm.city,area:e.dataForm.area,street:e.dataForm.street,deptOrder:e.dataForm.deptOrder}}).then(function(t){var a=t.data;a&&a.successful?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.visible=!1,e.$emit("refreshDataList")}}):e.$message.error(a.message)})})}}}),i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:e.dataForm.id?"修改":"新增","close-on-click-modal":!1,visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"120px"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.dataFormSubmit()}}},[a("el-form-item",{attrs:{label:"上级部门",prop:"name"}},[a("el-popover",{ref:"menuListPopover",attrs:{placement:"bottom-start",trigger:"click"}},[a("el-tree",{ref:"deptListTree",attrs:{data:e.deptList,props:e.deptListTreeProps,"node-key":"id","default-expand-all":!0,"highlight-current":!0,"expand-on-click-node":!1},on:{"current-change":e.deptListTreeCurrentChangeHandle}})],1),e._v(" "),a("el-input",{directives:[{name:"popover",rawName:"v-popover:menuListPopover",arg:"menuListPopover"}],staticClass:"menu-list__input",attrs:{readonly:!0,placeholder:"点击选择上级部门，默认根目录下添加"},model:{value:e.dataForm.name,callback:function(t){e.$set(e.dataForm,"name",t)},expression:"dataForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"部门名称",prop:"deptName"}},[a("el-input",{attrs:{placeholder:"部门名称，长度不超过10个字"},model:{value:e.dataForm.deptName,callback:function(t){e.$set(e.dataForm,"deptName",t)},expression:"dataForm.deptName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"省/直辖市",prop:"province"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:""},on:{change:e.proChange},model:{value:e.dataForm.province,callback:function(t){e.$set(e.dataForm,"province",t)},expression:"dataForm.province"}},e._l(e.dataForm.proList,function(e){return a("el-option",{attrs:{label:e.dataName,value:e.dataCode}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"市/直辖市区",prop:"city"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:""},on:{change:e.cityChange},model:{value:e.dataForm.city,callback:function(t){e.$set(e.dataForm,"city",t)},expression:"dataForm.city"}},e._l(e.dataForm.cityList,function(e){return a("el-option",{attrs:{label:e.dataName,value:e.dataCode}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"区/县",prop:"area"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:""},model:{value:e.dataForm.area,callback:function(t){e.$set(e.dataForm,"area",t)},expression:"dataForm.area"}},e._l(e.dataForm.areaList,function(e){return a("el-option",{attrs:{label:e.dataName,value:e.dataCode}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"详细地址",prop:"street"}},[a("el-input",{attrs:{placeholder:"街道"},model:{value:e.dataForm.street,callback:function(t){e.$set(e.dataForm,"street",t)},expression:"dataForm.street"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序号",prop:"deptOrder"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,label:"排序号"},model:{value:e.dataForm.deptOrder,callback:function(t){e.$set(e.dataForm,"deptOrder",t)},expression:"dataForm.deptOrder"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型",size:"mini",prop:"parentType"}},[a("el-radio-group",{model:{value:e.dataForm.parentType,callback:function(t){e.$set(e.dataForm,"parentType",t)},expression:"dataForm.parentType"}},[a("el-radio",{attrs:{label:1}},[e._v("地区监管部门")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("行业监管部门")])],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},staticRenderFns:[]};var o=a("46Yf")(n,i,!1,function(e){a("DAgR")},null,null);t.default=o.exports},iPNa:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("7+Dk"),n=a("QowZ"),i=a("0xDb"),o={data:function(){return{dataForm:{},dataList:[],dataListLoading:!1,addOrUpdateVisible:!1,permission:[],permissionVisible:{add:!1,update:!1,delete:!1}}},components:{TableTreeColumn:r.a,AddOrUpdate:n.default},activated:function(){this.getDataList()},mounted:function(){this.getPermission()},methods:{getPermission:function(){var e=this;this.$http({url:this.$http.adornUrl("/sys/menuPermission"),method:"get",params:this.$http.adornParams({menuId:this.$route.meta.menuId})}).then(function(t){var a=t.data;e.permission=a;for(var r=0;r<a.length;r++)switch(a[r].split(":")[1]){case"add":e.permissionVisible.add=!0;break;case"update":e.permissionVisible.update=!0;break;case"delete":e.permissionVisible.delete=!0}})},hasPermission:function(e){switch(e){case"add":return this.permissionVisible.add;case"update":return this.permissionVisible.update;case"delete":return this.permissionVisible.delete;default:return!1}},getDataList:function(){var e=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/dept/list"),method:"get",params:this.$http.adornParams()}).then(function(t){var a=t.data;a.successful?(e.dataList=Object(i.c)(a.data,"id","parentId"),e.dataListLoading=!1):(console.log("ERROR",a),e.$message.error("操作失败"))})},addOrUpdateHandle:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick(function(){t.$refs.addOrUpdate.init(e)})},deleteHandle:function(e){var t=this;this.$confirm("确定进行[删除]操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({url:t.$http.adornUrl("/dept/remove"),method:"get",params:t.$http.adornParams({id:e},!1)}).then(function(e){var a=e.data;a&&a.successful?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.getDataList()}}):t.$message.error(a.message)})}).catch(function(){})}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mod-menu"},[a("el-form",{attrs:{inline:!0,model:e.dataForm}},[a("el-form-item",[e.hasPermission("add")?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addOrUpdateHandle()}}},[e._v("新增")]):e._e()],1)],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataList,border:""}},[a("table-tree-column",{attrs:{prop:"deptName","header-align":"center",treeKey:"id",parentKey:"parentId",width:"150",label:"名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name","header-align":"center",align:"center",width:"120",label:"上级部门"}}),e._v(" "),a("el-table-column",{attrs:{prop:"parentType","header-align":"center",align:"center",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n      \t"+e._s("1"==t.row.parentType?"地区监管部门":"行业监管部门")+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"deptOrder","header-align":"center",align:"center",label:"排序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"province","header-align":"center",align:"center",width:"120",label:"省"}}),e._v(" "),a("el-table-column",{attrs:{prop:"city","header-align":"center",align:"center",width:"120",label:"市"}}),e._v(" "),a("el-table-column",{attrs:{prop:"area","header-align":"center",align:"center",width:"120",label:"区"}}),e._v(" "),a("el-table-column",{attrs:{fixed:"right","header-align":"center",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasPermission("update")?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.addOrUpdateHandle(t.row.id)}}},[e._v("修改")]):e._e(),e._v(" "),e.hasPermission("delete")?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.deleteHandle(t.row.id)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),e.addOrUpdateVisible?a("add-or-update",{ref:"addOrUpdate",on:{refreshDataList:e.getDataList}}):e._e()],1)},staticRenderFns:[]},s=a("46Yf")(o,d,!1,null,null,null);t.default=s.exports}});